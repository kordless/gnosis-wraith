<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gnosis Wraith</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/styles.css') }}"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <!-- Favicon links -->
    <link
      rel="icon"
      type="image/svg+xml"
      href="{{ url_for('static', filename='images/favicon.svg') }}"
    />
    <link
      rel="icon"
      type="image/x-icon"
      href="{{ url_for('static', filename='images/favicon.ico') }}"
    />
    <link
      rel="icon"
      href="{{ url_for('static', filename='images/favicon.ico') }}"
      type="image/x-icon"
    />
    <link
      rel="shortcut icon"
      href="{{ url_for('static', filename='images/favicon.ico') }}"
      type="image/x-icon"
    />
    <link
      rel="icon"
      type="image/svg+xml"
      href="{{ url_for('static', filename='images/favicon.svg') }}"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="{{ url_for('static', filename='images/favicon-128x128.png') }}"
    />
  </head>

  <body>
    <nav class="navbar">
      <div class="logo">
        <a href="{{ url_for('pages.index') }}">
          <span>Gnosis Wraith ðŸ‘»</span>
        </a>
      </div>
      <ul class="nav-menu">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle">
            <i class="fas fa-bars"></i>
          </a>
          <ul class="dropdown-menu">
            <li><a href="{{ url_for('pages.philosophy') }}">Philosophy</a></li>
            <li><a href="{{ url_for('pages.list_reports') }}">Reportage</a></li>
            <li><a href="{{ url_for('pages.settings') }}">Settings</a></li>
          </ul>
        </li>
      </ul>
    </nav>

    <div class="container">
      <div class="tabs">
        <button class="tab-btn active" data-tab="single-crawl">
          Single URL Crawl
        </button>
        <button class="tab-btn" data-tab="multi-crawl">Multi-URL Crawl</button>
        <button class="tab-btn" data-tab="image-upload">Upload Image</button>
        <button class="tab-btn" data-tab="extension">Browser Extension</button>
        <button class="tab-btn" data-tab="code-examples">Code Examples</button>
        <button class="tab-btn" data-tab="crawl-philosophy">
          Crawl Philosophy
        </button>
      </div>

      <main>
        <!-- Single URL Crawl Tab with JavaScript Option -->
        <section id="single-crawl" class="tab-content card active">
          <h2>Crawl Single URL</h2>
          <div class="author-quote">
            <blockquote>
              "The difference between ignorant and educated people is that the
              latter know more facts. But that has nothing to do with whether
              they are stupid or intelligent."
              <cite>â€” Neal Stephenson, The Diamond Age</cite>
            </blockquote>
          </div>
          <div class="crawl-form">
            <div class="form-group">
              <label for="url">URL:</label>
              <input
                type="url"
                id="url"
                placeholder="https://news.ycombinator.com"
              />
            </div>

            <div class="form-group">
              <label for="report-title">Report Title:</label>
              <input type="text" id="report-title" placeholder="Crawl Report" />
            </div>

            <div class="form-group">
              <label for="output-format">Save Screenshots:</label>
              <select id="output-format">
                <option value="both" selected>Yes - Save Screenshots</option>
                <option value="markdown">No - Text Only</option>
              </select>
              <p class="help-text">
                Screenshots will still be displayed during crawling
              </p>
            </div>

            <div class="form-group">
              <label for="javascript-enabled-single">JavaScript:</label>
              <select id="javascript-enabled-single">
                <option value="false" selected>Disabled (safer)</option>
                <option value="true">Enabled (better rendering)</option>
              </select>
              <p class="help-text">
                Enable JavaScript when crawling this website
              </p>
            </div>

            <div class="form-group">
              <button id="crawl-btn" class="btn primary">Start Crawling</button>
            </div>
          </div>

          <div id="crawl-status" class="status-box" style="display: none">
            <p>Status: <span id="status-text">Idle</span></p>
            <div class="progress-bar">
              <div id="progress-indicator"></div>
            </div>
          </div>
        </section>

        <!-- Multi URL Crawl Tab with JavaScript Option -->
        <section id="multi-crawl" class="tab-content card">
          <h2>Crawl Multiple URLs</h2>
          <div class="author-quote">
            <blockquote>
              "The most exciting phrase to hear in science, the one that heralds
              new discoveries, is not 'Eureka!' but 'That's funny...'"
              <cite>â€” Isaac Asimov</cite>
            </blockquote>
          </div>
          <div class="crawl-form">
            <div class="form-group">
              <label for="urls">URLs (one per line):</label>
              <textarea
                id="urls"
                placeholder="https://news.ycombinator.com"
              ></textarea>
            </div>

            <div class="form-group">
              <label for="multi-report-title">Report Title:</label>
              <input
                type="text"
                id="multi-report-title"
                placeholder="Multi Crawl Report"
              />
            </div>

            <div class="form-group">
              <label for="multi-output-format">Save Screenshots:</label>
              <select id="multi-output-format">
                <option value="both" selected>Yes - Save Screenshots</option>
                <option value="markdown">No - Text Only</option>
              </select>
              <p class="help-text">
                Screenshots will still be displayed during crawling
              </p>
            </div>

            <div class="form-group">
              <label for="javascript-enabled-multi">JavaScript:</label>
              <select id="javascript-enabled-multi">
                <option value="false" selected>Disabled (safer)</option>
                <option value="true">Enabled (better rendering)</option>
              </select>
              <p class="help-text">
                Enable JavaScript when crawling these websites
              </p>
            </div>

            <div class="form-group">
              <button id="multi-crawl-btn" class="btn primary">
                Start Crawling
              </button>
            </div>
          </div>

          <div id="multi-crawl-status" class="status-box" style="display: none">
            <p>Status: <span id="multi-status-text">Idle</span></p>
            <div class="progress-bar">
              <div id="multi-progress-indicator"></div>
            </div>
          </div>
        </section>

        <!-- Image Upload Tab -->
        <section id="image-upload" class="tab-content card">
          <h2>Upload Image</h2>
          <div class="author-quote">
            <blockquote>
              "Reality is that which, when you stop believing in it, doesn't go
              away."
              <cite>â€” Philip K. Dick</cite>
            </blockquote>
          </div>
          <div class="upload-form">
            <div class="form-group">
              <label for="image-file-input">Select Image:</label>
              <input type="file" id="image-file-input" accept="image/*" />
            </div>

            <div class="form-group">
              <label for="image-report-title">Report Title:</label>
              <input
                type="text"
                id="image-report-title"
                placeholder="Image Analysis Report"
              />
            </div>

            <div class="form-group">
              <button id="upload-btn" class="btn primary">
                Upload & Extract Text
              </button>
            </div>
          </div>

          <div id="upload-status" class="status-box" style="display: none">
            <p>Status: <span id="upload-status-text">Idle</span></p>
            <div class="progress-bar">
              <div id="upload-progress-indicator"></div>
            </div>
          </div>

          <div id="upload-result" class="result-box" style="display: none">
            <h3>Uploaded Image</h3>
            <div class="image-preview">
              <img id="preview-image" src="" alt="Uploaded image" />
            </div>

            <h3>Extracted Text</h3>
            <div class="extracted-text">
              <pre id="extracted-text-content"></pre>
            </div>
          </div>
        </section>

        <!-- Code Examples Tab -->
        <section id="code-examples" class="tab-content card">
          <h2>Code Examples</h2>

          <div class="author-quote">
            <blockquote>
              "I'm going to kill you with my teacup."
              <cite>â€” Richard B. Riddick, The Chronicles of Riddick</cite>
            </blockquote>
          </div>

          <div class="code-section">
            <h3>Python Code for Image Upload</h3>
            <p class="code-explanation">
              This function takes a local image file and uploads it to Gnosis
              Wraith's API for text extraction. It handles file validation,
              proper cleanup of resources, and returns the extracted text in
              JSON format.
            </p>
            <div class="code-container">
              <button class="copy-btn" title="Copy to clipboard">
                <i class="fas fa-copy"></i>
              </button>
              <pre
                class="language-python"
                style="font-size: 0.75em"
              ><code>import requests
import os

def upload_image_to_gnosis_wraith(image_path):
    """
    Upload an image to the Gnosis Wraith API and extract text.
    
    Args:
        image_path (str): Path to the image file
        
    Returns:
        dict: API response with extracted text
    """
    url = "http://localhost:5678/api/upload"
    
    if not os.path.exists(image_path):
        raise FileNotFoundError(f"Image file not found: {image_path}")
    
    files = {
        'image': (os.path.basename(image_path), open(image_path, 'rb'), 'image/png')
    }
    
    try:
        response = requests.post(url, files=files)
        response.raise_for_status()
        return response.json()
    except requests.exceptions.RequestException as e:
        print(f"Error uploading image: {e}")
        return None
    finally:
        files['image'][1].close()

# Example usage
if __name__ == "__main__":
    result = upload_image_to_gnosis_wraith("path/to/your/image.png")
    if result and result.get("success"):
        print(f"Extracted text: {result['extracted_text']}")
    else:
        print("Failed to extract text from image")</code></pre>
            </div>
          </div>

          <div class="code-section">
            <h3>Python Code for Web Crawling</h3>
            <p class="code-explanation">
              This function sends a crawl request to Gnosis Wraith with
              configurable options including JavaScript rendering and LLM
              integration. It processes the response to extract titles and text
              content from the crawled pages.
            </p>
            <div class="code-container">
              <button class="copy-btn" title="Copy to clipboard">
                <i class="fas fa-copy"></i>
              </button>
              <pre
                class="language-python"
                style="font-size: 0.75em"
              ><code>import requests
import json

def crawl_url_with_gnosis_wraith(url, javascript_enabled=False, llm_provider=None, llm_token=None):
    """
    Crawl a URL with Gnosis Wraith and get the extracted text and optionally LLM summary.
    
    Args:
        url (str): The URL to crawl
        javascript_enabled (bool): Whether to enable JavaScript for the crawl
        llm_provider (str, optional): LLM provider to use for summarization (e.g., 'anthropic', 'openai')
        llm_token (str, optional): API token for the LLM provider
        
    Returns:
        dict: API response with crawl results
    """
    api_url = "http://localhost:5678/api/crawl"
    
    payload = {
        "url": url,
        "javascript_enabled": javascript_enabled,
        "output_format": "markdown"
    }
    
    # Add LLM configuration if provided
    if llm_provider and llm_token:
        payload["llm_provider"] = llm_provider
        payload["llm_token"] = llm_token
    
    try:
        response = requests.post(
            api_url,
            headers={"Content-Type": "application/json"},
            data=json.dumps(payload)
        )
        response.raise_for_status()
        return response.json()
    except requests.exceptions.RequestException as e:
        print(f"Error during crawl: {e}")
        return None

# Example usage
if __name__ == "__main__":
    result = crawl_url_with_gnosis_wraith(
        url="https://example.com",
        javascript_enabled=True
    )
    
    if result and result.get("success"):
        print(f"Processed {len(result['results'])} URLs")
        
        # Print first result details
        if result['results']:
            first_result = result['results'][0]
            print(f"Title: {first_result.get('title')}")
            print(f"Extract: {first_result.get('extracted_text', '')[:100]}...")
    else:
        print("Crawl failed")</code></pre>
            </div>
          </div>
        </section>

        <!-- Browser Extension Tab -->
        <section id="extension" class="tab-content card">
          <h2>Browser Extension</h2>
          <div class="author-quote">
            <blockquote>
              "The study of exobiology is indeed a worthwhile endeavor, but to
              predict beyond the data is illogical."
              <cite>â€” Data, Star Trek: The Next Generation</cite>
            </blockquote>
          </div>
          <p class="extension-description">
            Download the WebWraith browser extension to analyze links before
            clicking, capture screenshots, and extract text from webpages
            directly in your browser.
          </p>

          <div class="install-instructions">
            <h3>Installation Instructions</h3>
            <ol>
              <li>Download and extract the zip file</li>
              <li>Open your browser's extension management page</li>
              <li>Enable "Developer mode"</li>
              <li>Click "Load unpacked" and select the extracted folder</li>
            </ol>
            <p>Compatible with Chrome, Firefox, and Edge browsers.</p>

            <div style="margin-top: 20px">
              <a
                href="{{ url_for('serve_extension') }}"
                class="btn primary download-btn"
                style="font-size: 0.9em; padding: 8px 16px"
              >
                <i class="fas fa-download"></i> Download Extension (v1.0.4)
              </a>
            </div>
          </div>
        </section>

        <!-- Crawl Philosophy Tab -->
        <section id="crawl-philosophy" class="tab-content card">
          <h2>Seeing Philosophy</h2>
          <div class="author-quote">
            <blockquote>
              "Not everything that can be counted counts, and not everything
              that counts can be counted."
              <cite>â€” Albert Einstein</cite>
            </blockquote>
          </div>

          <div class="philosophy-content">
            <h3>On Recursive Seeing (Crawling)</h3>

            <p>Recursive crawling is cheap until it isn't.</p>

            <p>
              It looks efficientâ€”"just follow the links"â€”but what you get is a
              tangle of algorithms chasing shadows:
            </p>

            <ul class="philosophy-list">
              <li>SEO traps</li>
              <li>Pagination loops</li>
              <li>Session ID noise</li>
              <li>Infinite comment threads</li>
              <li>JavaScript-rendered redirects that never settle</li>
            </ul>

            <p>It's not perception. It's just thrashing.</p>

            <p>Wraith doesn't follow links.</p>

            <p class="highlighted-text">
              "What are you actually trying to learn?"<br />
              "Where does context begin and end?"
            </p>

            <p>
              If you want recursion, you will need to define the pattern within
              your own code. Wraith is happy to process any URL you send it and
              return the data it understands about that resource. This includes
              links, extracted text, extracted images and summaries.
            </p>

            <p>
              Because perception without discrimination isn't awareness. It's
              just motion.
            </p>

            <div
              class="cta-buttons"
              style="margin-top: 30px; text-align: center"
            >
              <a href="{{ url_for('pages.philosophy') }}" class="btn primary"
                >Explore Full Gnosis Philosophy</a
              >
            </div>
          </div>
        </section>

        <!-- Crawl Results Section (Shared between tabs) -->
        <section id="crawl-results" class="card" style="display: none">
          <h2>Crawl Results</h2>
          <div id="results-summary"></div>
          <div id="results-content"></div>
          <div id="results-actions">
            <a
              id="report-link"
              href="#"
              class="btn secondary"
              style="display: none"
              >View Report</a
            >
            <a
              id="html-link"
              href="#"
              class="btn secondary"
              style="display: none"
              >View HTML</a
            >
          </div>
        </section>
      </main>

      <footer>
        <p>&copy; 2025 DeepBlue Dynamics. All rights reserved.</p>
        <div class="nav-links">
          <button
            onclick="window.open('https://github.com/kordless/webwraith', '_blank')"
            class="github-button"
            title="GitHub Repository"
          >
            <i class="fab fa-github"></i>
            <span class="star-count"
              ><i class="fas fa-star"></i>
              <span id="github-stars">178</span></span
            >
          </button>
        </div>
      </footer>
    </div>

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
  </body>
</html>
